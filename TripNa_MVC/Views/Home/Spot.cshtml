
@model PaginatedList2<TripNa_MVC.Models.Spot>
 @using Microsoft.AspNetCore.Http
    @inject Microsoft.AspNetCore.Http.IHttpContextAccessor hca

@{
    ViewData["Title"] = "Spot";
    Layout = "~/Views/Shared/_Layout.cshtml";

}




<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <link href="/css/information.css" rel="stylesheet" />
    

	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
			integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
			crossorigin="anonymous"></script>
   


    <!-- 字體 -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>

<body id="body">

    @* <div class="container" > *@

    @*   <div>
    <h1 class="text-center">TripNa Member Center</h1>

    <h4 id="title" class="text-center"> 會員中心</h4>
    <<<<<<< Updated upstream
    </div>



    <br>

    <div id="topIcon" class="row">

    <div class="col-sm-2 text-center"></div>

    <div class="col-sm-8 text-center">
    <a href="myorder.html"><img src="~/_img/png/myorder.png" alt=""></a>
    <a href="mycoupon.html"><img src="~/_img/png/coupon.png" alt=""></a>
    <a href="mycollect.html"><img src="~/_img/png/likelist.png" alt=""></a>
    <a href="/mydata.html"><img src="~/_img/png/mydata.png" alt=""></a>
    <a href="/sign.html"><img src="~/_img/png/sign.png" alt=""></a>
    =======
    >>>>>>> Stashed changes
    </div>

    *@


    <div class="col-sm-2 text-center"></div>



	<div id="food-guide" style="width:95%; margin-top:3rem;padding-top:12rem;">
		
                    <div class="guide-content">
			<h2>景點介紹</h2>
			<img src="/_img/S4_Travelling_by_Сar-removebg-preview.png" alt="Alternate Text" width="350px" height="300px" style="position:absolute;top:-60px;left:30px;" />
                        <img src="/_img/sleeping-dog-with-cloud.png" alt="Alternate Text" style="position:absolute;bottom:0;" width="300px" height="300px"/>
		
            <hr style="color:black;" />
			@* <img src="/_img/S1_Car.png" id="car" alt="Alternate Text"  style="position:absolute;"/>  *@
                        <br />  <br />
           
                    </div>


                    <form asp-action="spot" method="get">
                        <div class="form-actions no-color" style="margin-left:100px;">
                            <p style="width:auto;">

                                <input type="text" name="SearchString"  value="@ViewData["CurrentFilter"]"  placeholder="開始探索景點" id="search" />
                                <input type="submit" value="搜尋" class="back" /> |
                                <a asp-action="spot" class="backserch">回到景點總覽</a>
                            </p>
                        </div>
                    </form>

                    <div class="sidebar_spot">
                        <a asp-action="Spot" asp-route-sortOrder="@ViewData["DateSortParm"]" asp-route-currentFilter="@ViewData["CurrentFilter"]" id="locabtn">根據縣市排序</a>
                        <button class="btn btn-light " type="button" data-bs-toggle="collapse" data-bs-target="#regionCollapse" aria-expanded="false" aria-controls="regionCollapse" style="width:100px;margin-bottom:5px" id="filter">
                            <img src="~/_img/篩選 (2).png" alt="Alternate Text" width="20px" height="20px" style="margin-right:5px;" />  篩選
                        </button>
                        <div class="collapse" id="regionCollapse" style="position:relative;">
                            <p style="background-color:#cdcfee4f; padding:5px;width:98%;">選擇區域</p>
                            <ul id="selectedregion-spot">
                    @* ------------------------------------------------------------------- *@
                    @foreach (var spotcity in ViewBag.SpotCity)
                    {
                                    <li>
                                        <input type="checkbox" name="selectedRegions" value="@spotcity" id="region-@spotcity" class="spotcity-checkbox" />
                                        <label for="spotcity-@spotcity">@spotcity</label>
                                    </li>
                    }


                            </ul>

                            <li style="list-style-type:none"><a href="javascript:void(0)" id="cancel"><img src="/_img/取消.png" alt="Alternate Text" width="20px" height="20px" /></a></li>
                        </div>
                    </div>
                    <br /><br />


        <div style="position:relative;">
            @* <img src="/_img/S1_Car.png" id="car_2" alt="Alternate Text" style="position:absolute;" /> *@
			<h2 id="topic">精選主題</h2>
            <img src="/_img/S1_Car__1_-removebg-preview.png" alt="Alternate Text" width="100px" height="100px" style="position:absolute;left:220px;top:5px;" />
        <ul id="selectedregion-spot_topic">
				
                        <a asp-action="Spot" asp-controller="Home" asp-route-searchString="夜市">夜市</a>
                        <a asp-action="Spot" asp-controller="Home" asp-route-searchString="海洋">海邊</a>
                        <a asp-action="Spot" asp-controller="Home" asp-route-searchString="老街">老街</a>
                        <a asp-action="Spot" asp-controller="Home" asp-route-searchString="漁港">漁港</a>
                        <a asp-action="Spot" asp-controller="Home" asp-route-searchString="農場">農場</a>
                        <a asp-action="Spot" asp-controller="Home" asp-route-searchString="溫泉">溫泉</a>
                        <a asp-action="Spot" asp-controller="Home" asp-route-searchString="教堂">教堂</a>
                        <a asp-action="Spot" asp-controller="Home" asp-route-searchString="風景區">風景區</a>
                        <a asp-action="Spot" asp-controller="Home" asp-route-searchString="國家公園">國家公園</a>


                    </ul>
        </div>
        <div class="main" style="position:relative;">
            
            <img id="suitcase" src="/_img/旅遊素材.png" alt="Alternate Text" style="position:absolute;" />
            <br />
       
      
            
                        <h2 id="spotlist">景點列表</h2>
            <img src="/_img/S1_Car__1_-removebg-preview.png" alt="Alternate Text" width="100px" height="100px" style="position:absolute;left:220px;top:105px;" />
            @* ------------------------------分頁按鈕---------------------------- *@

                        <div class="btn" style="position:absolute; right:32px;top:170px;margin:10px">

                @{
                    var prevDisabled = !Model.HasPreviousPage ? "disabled" : "";
                    var nextDisabled = !Model.HasNextPage ? "disabled" : "";
                }

                            <a asp-action="Spot"
                               asp-route-sortOrder="@ViewData["CurrentSort"]"
                               asp-route-pageNumber="@(Model.PageIndex - 1)"
                               asp-route-currentFilter="@ViewData["CurrentFilter"]"
                               class="btn btn-outline-secondary  @prevDisabled" style="margin-right:8px;">
                                <img src="/_img/arrow_back_ios_20dp_FILL0_wght400_GRAD0_opsz20.svg" alt="Alternate Text" style="margin-left:5px;margin-bottom:3px;" />
                            </a>
                            <a asp-action="Spot"
                               asp-route-sortOrder="@ViewData["CurrentSort"]"
                               asp-route-pageNumber="@(Model.PageIndex + 1)"
                               asp-route-currentFilter="@ViewData["CurrentFilter"]"
                               class="btn btn-outline-secondary @nextDisabled">
                                <img src="/_img/arrow_forward_ios_20dp_FILL0_wght400_GRAD0_opsz20.png" width="20px" height="20px" alt="Alternate Text" style="margin-left:5px;margin-bottom:3px;" />
                            </a>
				
                        </div>

			
            @* ----------------------------------------------------------------------- *@
                        <ul id="spotcity-list" style="padding:10px;">

                            <!-- 這裡將顯示篩選後的餐廳結果 -->
                            <partial name="_spotlist" />

                        </ul>


            
                    </div>
                </div>




    @*
                <select id="spots">
                @foreach (var city in distinctCities)
                {
                <option value="@city">@city</option>
                }
                </select>

                <div id="selectedCity"></div>

                <div id="spotImages"></div> *@


             


            </div>
            <br>
            <br>
            <br>
            <br>
        </div>









    @section Scripts {
        @* <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script> *@
        @* <script src="/js/jquery-3.7.1.js"></script> *@

        @* <script src="/lib/bootstrap/dist/js/bootstrap.min.js"></script> *@

        @*   <script>
        $(function () {
        $('#spots').change(function () {
        var selectedCity = $(this).find('option:selected').text();
        $('#selectedCity').text(selectedCity); *@

            <script src="/lib/jquery/dist/jquery.min.js"></script>
            @* <script src="~/lib/jquery/dist/jquery.min.js"></script> *@

            <script>
 

            // $('.favorite-btn').click(function () {
            //     console.log($(this));
            //     var spotId = $(this).data('spot-id');
            //     var isFavorite = $(this).hasClass('favorited');
              
         

            //     $.ajax({
            //         url: '/Home/ToggleFavorite',
            //         type: 'POST',
            //         data: {
            //             spotId: spotId,
            //             isFavorite: isFavorite
            //         },
            //         success: function (response) {
            //             if (response.success) {
            //                 // 切換收藏按鈕的狀態
            //                 var $btn = $('.favorite-btn[data-spot-id="' + spotId + '"]');
            //                 $btn.toggleClass('favorited');

                           
            //             } else {
            //                 // 處理錯誤
            //                 alert(response.message);
            //             }
            //         },
            //         error: function (xhr, status, error) {
            //             // 處理錯誤
            //             console.error(error);
            //         }
            //     });
            // });







                    //     });
                    // });

                $(function () {
                    // 當複選框的狀態改變時
                    $('input.spotcity-checkbox').change(function () {
                        var selectedRegions = $('input.spotcity-checkbox:checked').map(function () {
                            return this.value;
                        }).get();

                        // 發送 AJAX 請求
                        $.ajax({
                            url: '@Url.Action("GetFilteredSpots", "Home")', // 控制器動作方法的 URL
                            type: 'POST',
                            dataType: 'html',
                            data: { spotcity: selectedRegions },
                            success: function (result) {
                                $('#spotcity-list').html(result); // 更新餐廳列表
                                $("#result").hide();

                            },
                            error: function () {
                                console.log('發生錯誤');
                            }
                        });
                    });
                });

                $(function () {
                    // 當複選框的狀態改變時
                    $('input.cityareas-checkbox').change(function () {
                        var selectedRegions = $('input.cityareas-checkbox:checked').map(function () {
                            return this.value;
                        }).get();

                        // 發送 AJAX 請求
                        $.ajax({
                            url: '@Url.Action("GetFilteredSpots", "Home")', // 控制器動作方法的 URL
                            type: 'POST',
                            dataType: 'html',
                            data: { cityareas: selectedcityareas },
                            success: function (result) {
                                $('#spotcity-list').html(result); // 更新餐廳列表
                                $("#result").hide();

                            },
                            error: function () {
                                console.log('發生錯誤');
                            }
                        });
                    });
                });



                $("#filter").click(function () {
                    $(this).hide();
                    $("#locabtn").hide();
                    $("#regionCollapse").show();

                });

                $("#cancel").click(function () {
                    $("#regionCollapse").toggle();
                    $("#filter").toggle();
                    $("#locabtn").toggle();
                });
                // =====================================================================================================================
                // const imgContainers = document.querySelectorAll('.img-container');

                // imgContainers.forEach(container => {
                //     const img = container.querySelector('img');

                //     container.addEventListener('click', () => {
                //         container.classList.toggle('zoomed');

                //         if (container.classList.contains('zoomed')) {
                //             // 立即將圖片放大並移到更高層級
                //             img.style.transform = 'scale(1.5)';
                //             img.style.position = 'relative';
                //             img.style.zIndex = '1';
                //         } else {
                //             // 還原圖片大小和層級
                //             img.style.transform = 'none';
                //             img.style.position = 'static';
                //             img.style.zIndex = 'auto';
                //         }
                //     });
                // });


            // const imgContainers = document.querySelectorAll('.img-container');
            // const overlay = document.createElement('div');
            // overlay.classList.add('overlay');
            // document.body.appendChild(overlay);

            // imgContainers.forEach(container => {
            //     const img = container.querySelector('.img-zoom');
            //     container.addEventListener('click', () => {
            //         container.classList.toggle('zoomed');
            //         overlay.style.display = container.classList.contains('zoomed') ? 'flex' : 'none';
            //         if (container.classList.contains('zoomed')) {
            //             img.style.transform = 'scale(3)';
            //         } else {
            //             img.style.transform = 'none';
            //         }
            //     });
            // });



                // =====================================================================================


            </script>

         
    }
</body>
</html>